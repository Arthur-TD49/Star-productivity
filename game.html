<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Tasker Pro - Dashboard</title>
    <style>
        :root {
            --mac-bg: rgba(255, 255, 255, 0.7);
            --mac-border: rgba(255, 255, 255, 0.4);
            --accent: #007AFF;
            --success: #28cd41;
            --surface: rgba(255, 255, 255, 0.5);
        }

        body {
            background: url('https://images.unsplash.com/photo-1497215728101-856f4ea42174?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
            background-size: cover;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            margin: 0; padding: 20px; height: 100vh; display: flex; justify-content: center; align-items: center; box-sizing: border-box;
            overflow: hidden;
        }

        /* Effet de flou sur le fond */
        .app-container {
            width: 100%; max-width: 1200px; height: 90vh;
            background: var(--mac-bg);
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            border-radius: 24px; border: 1px solid var(--mac-border);
            display: flex; flex-direction: column;
            box-shadow: 0 50px 100px rgba(0,0,0,0.3);
            animation: appAppear 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes appAppear { from { opacity: 0; transform: scale(0.95) translateY(20px); } }

        /* Barre de titre √©l√©gante */
        .title-bar {
            height: 60px; display: flex; align-items: center; padding: 0 25px;
            background: rgba(255,255,255,0.2); border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .dots { display: flex; gap: 8px; width: 80px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .red { background: #FF5F56; } .yellow { background: #FFBD2E; } .green { background: #27C93F; }

        .xp-container { flex: 1; margin: 0 40px; }
        .xp-label { font-size: 11px; font-weight: 700; color: #666; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
        .xp-bar { height: 6px; background: rgba(0,0,0,0.08); border-radius: 10px; overflow: hidden; }
        #xp-fill { height: 100%; background: linear-gradient(90deg, #007AFF, #5AC8FA); width: 0%; transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }

        .star-wallet { 
            background: white; padding: 8px 18px; border-radius: 20px; 
            font-weight: 800; color: #f39c12; font-size: 1.1em;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        /* Layout */
        .main-layout { display: flex; flex: 1; overflow: hidden; }

        /* Widgets Sidebar */
        .widgets-bar { 
            width: 200px; padding: 25px 15px; 
            background: rgba(255,255,255,0.15); border-right: 1px solid rgba(0,0,0,0.05);
        }
        .widget { 
            background: var(--surface); padding: 18px; border-radius: 20px; 
            margin-bottom: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.4);
            transition: 0.3s;
        }
        .widget:hover { background: white; transform: translateY(-2px); }
        .widget small { color: #888; font-size: 10px; font-weight: 800; letter-spacing: 1px; }
        .widget b { display: block; font-size: 16px; margin-top: 5px; color: #333; }

        /* Sections de contenu */
        .shop-column { width: 320px; padding: 25px; overflow-y: auto; background: rgba(255,255,255,0.1); }
        .task-column { flex: 1; padding: 25px; overflow-y: auto; }

        /* Cards */
        .card { 
            background: white; padding: 20px; border-radius: 20px; margin-bottom: 15px;
            border: 1px solid rgba(0,0,0,0.03); box-shadow: 0 4px 12px rgba(0,0,0,0.03);
            transition: 0.3s cubic-bezier(0.2, 0, 0, 1);
        }
        .card:hover { box-shadow: 0 10px 25px rgba(0,0,0,0.08); }

        h3 { margin: 0 0 20px 0; font-size: 18px; font-weight: 700; color: #1d1d1f; }

        /* Input Styles */
        input, select { 
            width: 100%; padding: 12px; margin-bottom: 12px; border-radius: 12px; 
            border: 1px solid rgba(0,0,0,0.1); background: #f5f5f7; font-size: 14px; outline: none;
        }
        input:focus { border-color: var(--accent); background: white; }

        button { 
            background: var(--accent); color: white; border: none; padding: 12px; 
            border-radius: 12px; cursor: pointer; font-weight: 600; width: 100%;
            transition: 0.2s;
        }
        button:hover { opacity: 0.9; transform: scale(0.98); }
        button:active { transform: scale(0.95); }

        /* Task Items */
        .task-item {
            display: flex; justify-content: space-between; align-items: center;
            animation: taskIn 0.4s ease forwards;
        }
        @keyframes taskIn { from { opacity: 0; transform: translateX(-10px); } }

        .reward-pill { 
            background: #fff9e6; color: #f39c12; padding: 6px 12px; 
            border-radius: 20px; font-size: 12px; font-weight: 800; 
        }

        /* Notification */
        #notify-stack { position: fixed; top: 20px; right: 20px; z-index: 999; display: flex; flex-direction: column; gap: 10px; }
        .mac-toast {
            background: rgba(255,255,255,0.8); backdrop-filter: blur(15px);
            padding: 15px 20px; border-radius: 18px; min-width: 250px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15); border: 1px solid white;
            animation: toastIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes toastIn { from { opacity: 0; transform: translateX(50px); } }

        .timer-float {
            position: fixed; bottom: 30px; left: 30px; 
            background: #1d1d1f; color: white; padding: 15px 25px;
            border-radius: 50px; display: flex; align-items: center; gap: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3); z-index: 1000;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .widgets-bar { display: none; }
            .main-layout { flex-direction: column; }
            .shop-column { width: 100%; height: 250px; }
        }
    </style>
</head>
<body>

<div id="notify-stack"></div>
<div id="timer-ui" class="timer-float" style="display:none"></div>

<div class="app-container">
    <div class="title-bar">
        <div class="dots">
            <div class="dot red"></div>
            <div class="dot yellow"></div>
            <div class="dot green"></div>
        </div>
        <div class="xp-container">
            <div class="xp-label">Progression Niveau <span id="lvl-badge">1</span></div>
            <div class="xp-bar"><div id="xp-fill"></div></div>
        </div>
        <div class="star-wallet">‚≠ê <span id="starsDisplay">0</span></div>
    </div>

    <div class="main-layout">
        <div class="widgets-bar">
            <div class="widget">
                <small>RANG</small>
                <b id="rankName">Stagiaire</b>
            </div>
            <div class="widget">
                <small>M√âT√âO TRAVAIL</small>
                <b id="weather">D√©gag√©</b>
            </div>
            <div class="widget">
                <small>FOCUS XP</small>
                <b>+10%</b>
            </div>
        </div>

        <div class="shop-column">
            <h3>Boutique</h3>
            
            <div class="card">
                <b>üéÆ Session Gaming (1h)</b>
                <p style="font-size:12px; color:#888;">Utilisez vos √©toiles pour jouer.</p>
                <button onclick="buy(150, 'Gaming', 60)">Acheter ‚Äî 150 ‚≠ê</button>
            </div>

            <div class="card">
                <b>üìñ Temps Lecture (45m)</b>
                <p style="font-size:12px; color:#888;">Lire un livre ou un manga.</p>
                <button onclick="buy(60, 'Lecture', 45)">Acheter ‚Äî 60 ‚≠ê</button>
            </div>

            <div class="card" style="background: linear-gradient(135deg, #fff 0%, #f0f7ff 100%);">
                <b>üßò Mode Focus (25m)</b>
                <p style="font-size:12px; color:#888;">Travail intense sans distraction.</p>
                <button style="background: #000" onclick="startFocus()">Lancer Focus</button>
            </div>

            <div class="card">
                <b>üéÅ Bo√Æte Surprise</b>
                <button onclick="buyMystery()">Ouvrir ‚Äî 100 ‚≠ê</button>
            </div>
        </div>

        <div class="task-column">
            <h3>Mes Missions</h3>
            
            <div class="card" style="background: rgba(255,255,255,0.8);">
                <input type="text" id="taskName" placeholder="Ajouter une nouvelle mission...">
                <div style="display:flex; gap:10px;">
                    <select id="taskValue">
                        <option value="20">Facile (20 ‚≠ê)</option>
                        <option value="50">Moyen (50 ‚≠ê)</option>
                        <option value="150">Difficile (150 ‚≠ê)</option>
                    </select>
                    <button onclick="addTask()" style="width: 150px;">Ajouter</button>
                </div>
            </div>

            <div id="taskList"></div>
        </div>
    </div>
</div>

<script>
    let stars = parseInt(localStorage.getItem('stars')) || 0;
    let xp = parseInt(localStorage.getItem('xp')) || 0;
    let lvl = parseInt(localStorage.getItem('lvl')) || 1;
    let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

    const ranks = ["Stagiaire", "Apprenti", "Expert", "Ma√Ætre du Temps", "CEO de ma Vie"];

    function sendNotify(title, msg) {
        const stack = document.getElementById('notify-stack');
        const toast = document.createElement('div');
        toast.className = 'mac-toast';
        toast.innerHTML = `<strong style="display:block; margin-bottom:4px;">${title}</strong><span style="font-size:13px; color:#666;">${msg}</span>`;
        stack.appendChild(toast);
        setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 500); }, 4000);
    }

    function updateUI() {
        document.getElementById('starsDisplay').innerText = stars;
        document.getElementById('lvl-badge').innerText = lvl;
        document.getElementById('rankName').innerText = ranks[Math.min(lvl-1, 4)];
        
        // XP System
        let currentXP = xp % 100;
        document.getElementById('xp-fill').style.width = currentXP + "%";
        
        // Weather Widget
        document.getElementById('weather').innerText = tasks.length > 4 ? "Orageux" : "D√©gag√©";

        localStorage.setItem('stars', stars);
        localStorage.setItem('xp', xp);
        localStorage.setItem('lvl', lvl);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        renderTasks();
    }

    function addTask() {
        const input = document.getElementById('taskName');
        const val = document.getElementById('taskValue').value;
        if (!input.value) return;

        tasks.push({ id: Date.now(), name: input.value, reward: parseInt(val) });
        input.value = '';
        sendNotify("Mission cr√©√©e", "La productivit√© commence maintenant.");
        updateUI();
    }

    function renderTasks() {
        const list = document.getElementById('taskList');
        list.innerHTML = '';
        tasks.forEach(t => {
            const div = document.createElement('div');
            div.className = 'card task-item';
            div.innerHTML = `
                <div>
                    <span style="font-weight:600;">${t.name}</span>
                    <div style="margin-top:8px;"><span class="reward-pill">‚≠ê ${t.reward}</span></div>
                </div>
                <button onclick="complete(${t.id})" style="width:auto; padding:8px 20px; background:var(--success)">Valider</button>
            `;
            list.appendChild(div);
        });
    }

    function complete(id) {
        const idx = tasks.findIndex(t => t.id === id);
        const reward = tasks[idx].reward;
        stars += reward;
        xp += 20;

        if (xp >= lvl * 100) {
            lvl++;
            sendNotify("NIVEAU SUP√âRIEUR", "Vous √™tes maintenant niveau " + lvl);
        }

        tasks.splice(idx, 1);
        sendNotify("T√¢che termin√©e", "+" + reward + " √©toiles gagn√©es.");
        updateUI();
    }

    function buy(cost, label, mins) {
        if (stars >= cost) {
            stars -= cost;
            startTimer(label, mins);
            sendNotify("Achat valid√©", "Votre r√©compense est active.");
            updateUI();
        } else {
            sendNotify("Erreur", "Nombre d'√©toiles insuffisant.");
        }
    }

    function startTimer(label, mins) {
        const ui = document.getElementById('timer-ui');
        ui.style.display = 'flex';
        let sec = mins * 60;
        const interval = setInterval(() => {
            let m = Math.floor(sec/60);
            let s = sec%60;
            ui.innerHTML = `<span>‚è≥ <strong>${label}</strong></span> <span style="color:var(--accent)">${m}:${s<10?'0':''}${s}</span>`;
            if (sec <= 0) { 
                clearInterval(interval); 
                ui.style.display = 'none'; 
                sendNotify("Fin du bonus", "Il est temps de se remettre au travail !");
            }
            sec--;
        }, 1000);
    }

    function startFocus() {
        sendNotify("Focus", "Session de 25 minutes lanc√©e.");
        startTimer("Concentration", 25);
    }

    function buyMystery() {
        if (stars >= 100) {
            stars -= 100;
            const win = Math.floor(Math.random() * 350);
            stars += win;
            sendNotify("Cadeau", `Vous avez trouv√© ${win} √©toiles !`);
            updateUI();
        }
    }

    updateUI();
</script>

</body>
</html>
